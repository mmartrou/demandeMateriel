{% extends "base.html" %}

{% block title %}Configuration Jours Ouvr√©s{% endblock %}

{% block content %}
<div class="container-fluid mt-4">
    <div class="row">
        <div class="col-12">
            <div class="d-flex justify-content-between align-items-center mb-4">
                <h2>üìÖ Configuration des Jours Ouvr√©s</h2>
                <a href="/admin" class="btn btn-secondary">
                    <i class="fas fa-arrow-left"></i> Retour Admin
                </a>
            </div>
            
            <!-- Instructions -->
            <div class="alert alert-info">
                <i class="fas fa-info-circle"></i>
                <strong>Instructions :</strong> 
                Cliquez sur un jour pour le marquer comme ouvr√© (vert) ou non-ouvr√© (rouge). 
                Les weekends sont non-ouvr√©s par d√©faut. Cette configuration affecte le calcul des d√©lais de 2 jours ouvr√©s.
            </div>

            <!-- Navigation mois -->
            <div class="card">
                <div class="card-header">
                    <div class="row align-items-center">
                        <div class="col-md-4">
                            <button class="btn btn-outline-primary" id="prevMonth">
                                <i class="fas fa-chevron-left"></i> Mois pr√©c√©dent
                            </button>
                        </div>
                        <div class="col-md-4 text-center">
                            <h4 id="currentMonthYear" class="mb-0"></h4>
                        </div>
                        <div class="col-md-4 text-end">
                            <button class="btn btn-outline-primary" id="nextMonth">
                                Mois suivant <i class="fas fa-chevron-right"></i>
                            </button>
                        </div>
                    </div>
                </div>
                
                <div class="card-body">
                    <!-- L√©gende -->
                    <div class="mb-3 text-center">
                        <span class="badge bg-success me-2">
                            <i class="fas fa-check"></i> Jour ouvr√©
                        </span>
                        <span class="badge bg-danger me-2">
                            <i class="fas fa-times"></i> Jour non-ouvr√©
                        </span>
                    </div>

                    <!-- Calendrier -->
                    <div id="workingDaysCalendar" class="calendar-container">
                        <div id="calendar-loading" class="text-center py-4">
                            <i class="fas fa-spinner fa-spin"></i> Chargement du calendrier...
                        </div>
                        <!-- Le calendrier sera g√©n√©r√© par JavaScript -->
                    </div>
                    
                    <!-- Debug info -->
                    <div id="debug-info" class="mt-3 p-2 bg-light rounded" style="display: none;">
                        <small class="text-muted">Debug: <span id="debug-text">Initialisation...</span></small>
                    </div>
                </div>
            </div>

            <!-- Actions rapides -->
            <div class="row mt-4">
                <div class="col-md-6">
                    <div class="card">
                        <div class="card-header">
                            <h5><i class="fas fa-hand-pointer"></i> S√©lection Multiple</h5>
                        </div>
                        <div class="card-body">
                            <p class="text-muted mb-3">
                                <small>
                                    <strong>Ctrl + Clic :</strong> S√©lection individuelle<br>
                                    <strong>Shift + Clic :</strong> S√©lection par plage
                                </small>
                            </p>
                            <div id="multiSelectControls" style="display: none;">
                                <div class="alert alert-info">
                                    <strong><span id="selectedDaysCount">0</span> jour(s) s√©lectionn√©(s)</strong>
                                </div>
                                <button class="btn btn-success btn-sm me-2" id="markSelectedWorking">
                                    <i class="fas fa-check"></i> Marquer comme ouvr√©
                                </button>
                                <button class="btn btn-danger btn-sm me-2" id="markSelectedNonWorking">
                                    <i class="fas fa-times"></i> Marquer comme non-ouvr√©
                                </button>
                                <button class="btn btn-secondary btn-sm" id="clearSelection">
                                    <i class="fas fa-times-circle"></i> Annuler s√©lection
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="col-md-6">
                    <div class="card">
                        <div class="card-header">
                            <h5><i class="fas fa-info"></i> Statistiques</h5>
                        </div>
                        <div class="card-body">
                            <div id="calendarStats">
                                <p class="mb-1">
                                    <strong>Jours ouvr√©s :</strong> 
                                    <span id="workingDaysCount" class="text-success">-</span>
                                </p>
                                <p class="mb-0">
                                    <strong>Jours non-ouvr√©s :</strong> 
                                    <span id="nonWorkingDaysCount" class="text-danger">-</span>
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Modal pour d√©tails jour -->
<div class="modal fade" id="dayDetailsModal" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">D√©tails du jour</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <form id="dayConfigForm">
                    <div class="mb-3">
                        <label class="form-label">Date :</label>
                        <input type="text" id="modalDate" class="form-control" readonly>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Statut :</label>
                        <div class="form-check">
                            <input class="form-check-input" type="radio" name="workingStatus" id="isWorking" value="true">
                            <label class="form-check-label text-success" for="isWorking">
                                <i class="fas fa-check"></i> Jour ouvr√©
                            </label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="radio" name="workingStatus" id="isNotWorking" value="false">
                            <label class="form-check-label text-danger" for="isNotWorking">
                                <i class="fas fa-times"></i> Jour non-ouvr√©
                            </label>
                        </div>
                    </div>
                    <div class="mb-3">
                        <label for="dayDescription" class="form-label">Description (optionnel) :</label>
                        <input type="text" class="form-control" id="dayDescription" placeholder="Ex: Jour f√©ri√©, Vacances...">
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Annuler</button>
                <button type="button" class="btn btn-danger" id="resetDayConfig">
                    <i class="fas fa-undo"></i> R√©initialiser
                </button>
                <button type="button" class="btn btn-primary" id="saveDayConfig">
                    <i class="fas fa-save"></i> Sauvegarder
                </button>
            </div>
        </div>
    </div>
</div>

<style>
.calendar-container {
    max-width: 100%;
    overflow-x: auto;
}

.calendar-table {
    width: 100%;
    border-collapse: collapse;
    margin: 0 auto;
}

.calendar-table th,
.calendar-table td {
    border: 1px solid #dee2e6;
    padding: 8px;
    text-align: center;
    vertical-align: middle;
    position: relative;
    min-width: 40px;
    height: 50px;
}

.calendar-table th {
    background-color: #f8f9fa;
    font-weight: bold;
}

.calendar-day {
    cursor: pointer;
    transition: all 0.3s ease;
    border-radius: 4px;
    margin: 2px;
    padding: 6px;
    min-height: 35px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: 500;
}

.calendar-day:hover {
    transform: scale(1.05);
    box-shadow: 0 2px 4px rgba(0,0,0,0.2);
}

.calendar-day.working {
    background-color: #d4edda;
    color: #155724;
    border: 2px solid #c3e6cb;
}

.calendar-day.non-working {
    background-color: #f8d7da;
    color: #721c24;
    border: 2px solid #f5c6cb;
}

.calendar-day.today {
    font-weight: bold;
    position: relative;
}

.calendar-day.today::before {
    content: '';
    position: absolute;
    top: 2px;
    right: 2px;
    width: 8px;
    height: 8px;
    background-color: #007bff;
    border-radius: 50%;
}

.calendar-day.selected {
    box-shadow: 0 0 0 3px #007bff;
    z-index: 1;
    position: relative;
}

.calendar-day.selected::after {
    content: '‚úì';
    position: absolute;
    top: 2px;
    left: 2px;
    font-size: 12px;
    font-weight: bold;
    color: #007bff;
    background: white;
    border-radius: 50%;
    width: 16px;
    height: 16px;
    display: flex;
    align-items: center;
    justify-content: center;
}

.other-month {
    opacity: 0.3;
}

.day-number {
    font-size: 14px;
    font-weight: bold;
}

.day-status {
    font-size: 10px;
    margin-top: 2px;
}

@media (max-width: 768px) {
    .calendar-table th,
    .calendar-table td {
        padding: 4px;
        min-width: 35px;
        height: 40px;
    }
    
    .calendar-day {
        padding: 4px;
        min-height: 30px;
    }
    
    .day-number {
        font-size: 12px;
    }
}
</style>
{% endblock %}

{% block extra_js %}
<script>
class WorkingDaysCalendar {
    constructor() {
        console.log('WorkingDaysCalendar: Initialisation...');
        this.debugElement = document.getElementById('debug-info');
        this.debugText = document.getElementById('debug-text');
        this.showDebug('Constructor d√©marr√©');
        
        this.currentDate = new Date();
        this.currentMonth = this.currentDate.getMonth();
        this.currentYear = this.currentDate.getFullYear();
        this.workingDaysConfig = {};
        this.selectedDate = null;
        
        // S√©lection multiple
        this.selectedDays = new Set();
        this.multiSelectMode = false;
        this.lastClickedDay = null;
        
        this.showDebug('Variables initialis√©es');
        this.init();
    }
    
    showDebug(message) {
        console.log('Calendar Debug:', message);
        if (this.debugElement && this.debugText) {
            this.debugElement.style.display = 'block';
            this.debugText.textContent = message;
        }
    }
    
    init() {
        this.showDebug('D√©but init()');
        try {
            this.bindEvents();
            this.showDebug('Events bind√©s');
            this.loadMonth();
            this.showDebug('Mois charg√©');
        } catch (error) {
            this.showDebug('Erreur init: ' + error.message);
            console.error('Erreur init calendrier:', error);
        }
    }
    
    bindEvents() {
        document.getElementById('prevMonth').addEventListener('click', () => {
            this.currentMonth--;
            if (this.currentMonth < 0) {
                this.currentMonth = 11;
                this.currentYear--;
            }
            this.loadMonth();
        });
        
        document.getElementById('nextMonth').addEventListener('click', () => {
            this.currentMonth++;
            if (this.currentMonth > 11) {
                this.currentMonth = 0;
                this.currentYear++;
            }
            this.loadMonth();
        });
        
        // Modal events
        document.getElementById('saveDayConfig').addEventListener('click', () => {
            this.saveDayConfig();
        });
        
        document.getElementById('resetDayConfig').addEventListener('click', () => {
            this.resetDayConfig();
        });
        
        // S√©lection multiple events
        document.getElementById('markSelectedWorking').addEventListener('click', () => {
            this.markSelectedAs(true);
        });
        
        document.getElementById('markSelectedNonWorking').addEventListener('click', () => {
            this.markSelectedAs(false);
        });
        
        document.getElementById('clearSelection').addEventListener('click', () => {
            this.clearSelection();
        });
        
        // √âcouter les touches Ctrl/Shift pour activer mode multi-s√©lection
        document.addEventListener('keydown', (e) => {
            if (e.ctrlKey || e.shiftKey) {
                this.multiSelectMode = true;
            }
        });
        
        document.addEventListener('keyup', (e) => {
            if (!e.ctrlKey && !e.shiftKey) {
                this.multiSelectMode = false;
            }
        });
    }
    
    async loadMonth() {
        this.showDebug(`Chargement mois ${this.currentMonth + 1}/${this.currentYear}`);
        const startDate = new Date(this.currentYear, this.currentMonth, 1);
        const endDate = new Date(this.currentYear, this.currentMonth + 1, 0);
        
        // Charger la configuration pour le mois
        try {
            const url = `/api/working-days?start_date=${this.formatDate(startDate)}&end_date=${this.formatDate(endDate)}`;
            this.showDebug(`Requ√™te API: ${url}`);
            
            const response = await fetch(url);
            if (response.ok) {
                const config = await response.json();
                this.workingDaysConfig = {};
                config.forEach(item => {
                    this.workingDaysConfig[item.date] = item;
                });
                this.showDebug(`Config charg√©e: ${config.length} √©l√©ments`);
            } else {
                this.showDebug(`Erreur API: ${response.status}`);
            }
        } catch (error) {
            this.showDebug(`Erreur fetch: ${error.message}`);
            console.error('Erreur chargement configuration:', error);
        }
        
        this.showDebug('D√©but rendu calendrier');
        this.renderCalendar();
        this.updateStats();
    }
    
    renderCalendar() {
        this.showDebug('renderCalendar() d√©marr√©');
        try {
            const monthNames = [
                'Janvier', 'F√©vrier', 'Mars', 'Avril', 'Mai', 'Juin',
                'Juillet', 'Ao√ªt', 'Septembre', 'Octobre', 'Novembre', 'D√©cembre'
            ];
            
            const dayNames = ['Lun', 'Mar', 'Mer', 'Jeu', 'Ven', 'Sam', 'Dim'];
            
            // Mise √† jour du titre
            const titleElement = document.getElementById('currentMonthYear');
            if (!titleElement) {
                this.showDebug('Erreur: √©l√©ment currentMonthYear non trouv√©');
                return;
            }
            
            titleElement.textContent = `${monthNames[this.currentMonth]} ${this.currentYear}`;
            this.showDebug('Titre mis √† jour');
            
            // G√©n√©ration du calendrier
            const firstDay = new Date(this.currentYear, this.currentMonth, 1);
            const lastDay = new Date(this.currentYear, this.currentMonth + 1, 0);
            const startCalendar = new Date(firstDay);
            // Ajuster pour commencer par lundi (0=dim, 1=lun, etc.)
            const dayOffset = firstDay.getDay() === 0 ? 6 : firstDay.getDay() - 1;
            startCalendar.setDate(startCalendar.getDate() - dayOffset);
        
        let html = '<table class="calendar-table table">';
        
        // En-t√™tes des jours
        html += '<thead><tr>';
        dayNames.forEach(day => {
            html += `<th>${day}</th>`;
        });
        html += '</tr></thead><tbody>';
        
        // G√©n√©ration des semaines
        const current = new Date(startCalendar);
        const today = new Date();
        
        while (current <= lastDay || current.getDay() !== 0) {
            html += '<tr>';
            
            for (let day = 0; day < 7; day++) {
                const dateStr = this.formatDate(current);
                const isCurrentMonth = current.getMonth() === this.currentMonth;
                const isToday = current.toDateString() === today.toDateString();
                const config = this.workingDaysConfig[dateStr];
                
                let dayClass = 'calendar-day';
                let statusIcon = '';
                
                // D√©terminer le statut du jour
                if (config) {
                    if (config.is_working_day) {
                        dayClass += ' working';
                        statusIcon = '<i class="fas fa-check"></i>';
                    } else {
                        dayClass += ' non-working';
                        statusIcon = '<i class="fas fa-times"></i>';
                    }
                } else {
                    // D√©faut: lun-ven ouvr√©s, WE non-ouvr√©s
                    const weekday = current.getDay();
                    if (weekday >= 1 && weekday <= 5) {
                        dayClass += ' working';
                        statusIcon = '<i class="fas fa-check"></i>';
                    } else {
                        dayClass += ' non-working';
                        statusIcon = '<i class="fas fa-times"></i>';
                    }
                }
                
                if (!isCurrentMonth) {
                    dayClass += ' other-month';
                }
                
                if (isToday) {
                    dayClass += ' today';
                }
                
                html += `
                    <td>
                        <div class="${dayClass}" data-date="${dateStr}" onclick="calendar.handleDayClick(event, '${dateStr}')">
                            <div class="day-number">${current.getDate()}</div>
                            <div class="day-status">${statusIcon}</div>
                        </div>
                    </td>
                `;
                
                current.setDate(current.getDate() + 1);
            }
            
            html += '</tr>';
            
            if (current > lastDay && current.getDay() === 1) break; // Arr√™ter au lundi suivant
        }
        
        html += '</tbody></table>';
        
        const calendarElement = document.getElementById('workingDaysCalendar');
        if (calendarElement) {
            calendarElement.innerHTML = html;
            this.showDebug('Calendrier HTML inject√©');
        } else {
            this.showDebug('Erreur: √©l√©ment workingDaysCalendar non trouv√©');
        }
        
        } catch (error) {
            this.showDebug('Erreur renderCalendar: ' + error.message);
            console.error('Erreur rendu calendrier:', error);
        }
    }
    
    formatDate(date) {
        // Avoid timezone shift: always use local date parts
        const year = date.getFullYear();
        const month = (date.getMonth() + 1).toString().padStart(2, '0');
        const day = date.getDate().toString().padStart(2, '0');
        return `${year}-${month}-${day}`;
    }
    
    handleDayClick(event, dateStr) {
        if (event.shiftKey && this.lastClickedDay) {
            // S√©lection par plage (Shift)
            event.preventDefault();
            this.selectRange(this.lastClickedDay, dateStr);
        } else if (event.ctrlKey) {
            // S√©lection multiple (Ctrl)
            event.preventDefault();
            this.toggleDaySelection(dateStr);
            this.lastClickedDay = dateStr;
        } else if (this.selectedDays.size > 0) {
            // Clic simple avec s√©lection active - annuler s√©lection
            this.clearSelection();
            this.openDayModal(dateStr);
        } else {
            // Clic normal
            this.openDayModal(dateStr);
            this.lastClickedDay = dateStr;
        }
    }
    
    toggleDaySelection(dateStr) {
        if (this.selectedDays.has(dateStr)) {
            this.selectedDays.delete(dateStr);
        } else {
            this.selectedDays.add(dateStr);
        }
        this.updateSelectionUI();
    }
    
    selectRange(startDateStr, endDateStr) {
        // Convertir les dates pour comparaison
        const startDate = new Date(startDateStr);
        const endDate = new Date(endDateStr);
        
        // S'assurer que startDate <= endDate
        const fromDate = startDate <= endDate ? startDate : endDate;
        const toDate = startDate <= endDate ? endDate : startDate;
        
        // Vider la s√©lection actuelle
        this.selectedDays.clear();
        
        // S√©lectionner tous les jours dans la plage
        const currentDate = new Date(fromDate);
        while (currentDate <= toDate) {
            const dateStr = this.formatDate(currentDate);
            this.selectedDays.add(dateStr);
            currentDate.setDate(currentDate.getDate() + 1);
        }
        
        this.updateSelectionUI();
    }
    
    updateSelectionUI() {
        // Mettre √† jour le compteur
        document.getElementById('selectedDaysCount').textContent = this.selectedDays.size;
        
        // Afficher/masquer les contr√¥les
        const controls = document.getElementById('multiSelectControls');
        if (this.selectedDays.size > 0) {
            controls.style.display = 'block';
        } else {
            controls.style.display = 'none';
        }
        
        // Mettre √† jour l'apparence des jours s√©lectionn√©s
        document.querySelectorAll('.calendar-day').forEach(dayElement => {
            const dateStr = dayElement.getAttribute('data-date');
            if (this.selectedDays.has(dateStr)) {
                dayElement.classList.add('selected');
            } else {
                dayElement.classList.remove('selected');
            }
        });
    }
    
    clearSelection() {
        this.selectedDays.clear();
        this.lastClickedDay = null;
        this.updateSelectionUI();
    }
    
    async markSelectedAs(isWorking) {
        if (this.selectedDays.size === 0) return;
        
        const updates = [];
        for (const dateStr of this.selectedDays) {
            updates.push({
                date: dateStr,
                is_working_day: isWorking,
                description: `Modification group√©e - ${isWorking ? 'Ouvr√©' : 'Non ouvr√©'}`
            });
        }
        
        try {
            const response = await fetch('/api/working-days/bulk', {
                method: 'PUT',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    updates: updates
                })
            });
            
            const result = await response.json();
            
            if (!response.ok) {
                throw new Error(result.error || 'Erreur lors de la mise √† jour');
            }
            
            // Recharger le mois pour refl√©ter les changements
            await this.loadMonth();
            this.clearSelection();
            
            let message = `${result.updated_count} jour(s) modifi√©(s) avec succ√®s !`;
            if (result.errors && result.errors.length > 0) {
                message += `\n\nAvertissements:\n${result.errors.join('\n')}`;
            }
            
            alert(message);
            
        } catch (error) {
            console.error('Erreur lors de la modification group√©e:', error);
            alert('Erreur lors de la modification : ' + error.message);
        }
    }
    
    openDayModal(dateStr) {
        this.selectedDate = dateStr;
        const config = this.workingDaysConfig[dateStr];
        
        document.getElementById('modalDate').value = dateStr;
        
        if (config) {
            document.getElementById(config.is_working_day ? 'isWorking' : 'isNotWorking').checked = true;
            document.getElementById('dayDescription').value = config.description || '';
        } else {
            // D√©faut bas√© sur le jour de la semaine
            const date = new Date(dateStr);
            const isWeekday = date.getDay() >= 1 && date.getDay() <= 5;
            document.getElementById(isWeekday ? 'isWorking' : 'isNotWorking').checked = true;
            document.getElementById('dayDescription').value = '';
        }
        
        new bootstrap.Modal(document.getElementById('dayDetailsModal')).show();
    }
    
    async saveDayConfig() {
        const isWorking = document.getElementById('isWorking').checked;
        const description = document.getElementById('dayDescription').value;
        
        try {
            const response = await fetch(`/api/working-days/${this.selectedDate}`, {
                method: 'PUT',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    is_working_day: isWorking,
                    description: description
                })
            });
            
            if (response.ok) {
                bootstrap.Modal.getInstance(document.getElementById('dayDetailsModal')).hide();
                this.loadMonth(); // Recharger le calendrier
                this.showNotification('Configuration sauvegard√©e avec succ√®s', 'success');
            } else {
                this.showNotification('Erreur lors de la sauvegarde', 'danger');
            }
        } catch (error) {
            console.error('Erreur sauvegarde:', error);
            this.showNotification('Erreur lors de la sauvegarde', 'danger');
        }
    }
    
    async resetDayConfig() {
        try {
            const response = await fetch(`/api/working-days/${this.selectedDate}`, {
                method: 'DELETE'
            });
            
            if (response.ok) {
                bootstrap.Modal.getInstance(document.getElementById('dayDetailsModal')).hide();
                this.loadMonth(); // Recharger le calendrier
                this.showNotification('Configuration r√©initialis√©e', 'info');
            } else {
                this.showNotification('Erreur lors de la r√©initialisation', 'danger');
            }
        } catch (error) {
            console.error('Erreur r√©initialisation:', error);
            this.showNotification('Erreur lors de la r√©initialisation', 'danger');
        }
    }
    
    updateStats() {
        let workingCount = 0;
        let nonWorkingCount = 0;
        
        // Calculer pour tous les jours du mois affich√©
        const firstDay = new Date(this.currentYear, this.currentMonth, 1);
        const lastDay = new Date(this.currentYear, this.currentMonth + 1, 0);
        
        const currentDate = new Date(firstDay);
        while (currentDate <= lastDay) {
            const dateStr = this.formatDate(currentDate);
            const config = this.workingDaysConfig[dateStr];
            
            let isWorking;
            if (config) {
                // Jour configur√©
                isWorking = config.is_working_day;
            } else {
                // Jour par d√©faut : lun-ven ouvr√©s, sam-dim non-ouvr√©s
                const weekday = currentDate.getDay();
                isWorking = weekday >= 1 && weekday <= 5;
            }
            
            if (isWorking) {
                workingCount++;
            } else {
                nonWorkingCount++;
            }
            
            currentDate.setDate(currentDate.getDate() + 1);
        }
        
        document.getElementById('workingDaysCount').textContent = workingCount;
        document.getElementById('nonWorkingDaysCount').textContent = nonWorkingCount;
    }
    
    showNotification(message, type) {
        // Cr√©er une notification toast
        const toastContainer = document.querySelector('.toast-container') || (() => {
            const container = document.createElement('div');
            container.className = 'toast-container position-fixed top-0 end-0 p-3';
            document.body.appendChild(container);
            return container;
        })();
        
        const toast = document.createElement('div');
        toast.className = `toast align-items-center text-bg-${type} border-0`;
        toast.setAttribute('role', 'alert');
        toast.innerHTML = `
            <div class="d-flex">
                <div class="toast-body">${message}</div>
                <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast"></button>
            </div>
        `;
        
        toastContainer.appendChild(toast);
        new bootstrap.Toast(toast).show();
        
        // Supprimer apr√®s 5 secondes
        setTimeout(() => {
            toast.remove();
        }, 5000);
    }
}

// Initialiser le calendrier
let calendar;
document.addEventListener('DOMContentLoaded', () => {
    calendar = new WorkingDaysCalendar();
});
</script>
{% endblock %}